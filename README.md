# TOFSense-python
---

## 简介

python driver for TOFSense

- TOFSense.py  驱动主要实现 支持TOFSense全系列
- demo.py   TOFSense-P/PS/F/FP 型号的demo
- demo_M.py  TOFSense-M/MS 型号的demo
  
PS：TOFSense-M4*4模式需要手动将self.datalen更新为TOFSENSE_DATA_LEN_M_44

## 使用

使用时提前实例化串口对象，并将串口对象传入实例化函数。
>*PS:串口号与波特率需要提前确认并更改*
>*串口号确认方法：*
>*我的电脑--设备管理器--端口(COM & LPT)--COMxx*
>*波特率确认方法：*
>*我的电脑--设备管理器--端口(COM & LPT)--COMxx--属性--波特率*
```
# 根据实际情况设置串口号和波特率
serial_port = "COM19"
baud_rate = 921600
ser = serial.Serial(serial_port, baud_rate)
```
*PS：报错could not open port 'COM19': PermissionError(13, '拒绝访问。', None, 5)，串口被占用，检查一下是否有后台其他程序占用了串口*
```
# 实例化对象

# TOFSense P/PS/F/FP 型号
t = TOFSense.TOFSense_P_F(ser)

# TOFSense M/MS 型号
t = TOFSense.TOFSense_M(ser)
```
```
# 主动输出模式读取数据

t.get_data()
```
```
# 查询输出模式读取数据

id = 0 # TOFSense ID
t.get_data_inquire(id)
```
输出格式
```
#TOFSense-P/PS/F/FP 型号输出格式示例
#{
#'id': 3, 
#'system_time': 34842, 
#'dis': 2.148, 
#'dis_status': 1, 
#'signal_strength': 518, 
#'range_precision': 2
#}

#TOFSense-M/MS 型号输出格式示例
#{
#'id': 3, 
#'system_time': 46961, 
#'zone_map': 64, 
#'dis': [1.24, 1.4, 1.61, 1.83, 1.77, 1.65, 1.53, 1.45, 1.44, 1.59, 2.06, 2.15, 2.14, 2.13, 2.07, 2.01, 1.67, 2.08, 2.2, 2.17, 2.17, 2.12, 2.1, 2.06, 2.16, 2.19, 2.17, 2.17, 2.15, 2.13, 2.09, 2.05, 2.22, 2.2, 2.16, 2.16, 2.14, 2.11, 2.06, 2.05, 2.2, 2.17, 2.17, 2.15, 2.11, 2.09, 2.06, 2.04, 2.22, 2.17, 2.14, 2.12, 2.08, 2.06, 2.05, 2.03, 2.17, 2.16, 2.13, 2.11, 2.09, 2.06, 2.03, 2.01], 
#'dis_status': [0, 0, 0, 0, 0, 0, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 
#'signal_strength': [56, 48, 34, 19, 16, 12, 25, 19, 39, 23, 28, 32, 33, 40, 29, 34, 22, 27, 34, 32, 38, 34, 38, 38, 25, 37, 33, 32, 39, 41, 47, 33, 34, 29, 34, 38, 37, 46, 37, 33, 27, 29, 33, 34, 33, 33, 32, 38, 21, 26, 32, 36, 29, 28, 37, 32, 25, 27, 30, 24, 20, 35, 32, 38]
#}
```